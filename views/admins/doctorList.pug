doctype html
html(lang='en')
   head
      title Homepage
      link(rel="stylesheet", href="/styles/form.css")
      link(rel="stylesheet", href="/styles/list.css")
   body
      //- ul
      //-    li
      //-       h4 Name
      //-       h4 DOB
      //-       h4 Gender
      //-       h4 Phone
      //-    each doctor in doctors
      //-       li
      //-          input(type='text', name='name', value = doctor.NAME, required='', readonly=true)
      //-          input(type='text', name='dob', value = doctor.DOB, required='', readonly=true)
      //-          input(type='text', name='gender', value = doctor.GENDER, required='', readonly=true)
      //-          input(type='text', name='phone', value = doctor.PHONE, required='', readonly=true)
      //-          form(action="/admin/doctor-list/delete/" + doctor.ID, method="POST")
      //-             input(type="submit" value="Delete")
      //-          button(type="button", class="update-button", onclick='getIndex(' + doctor.ID + ')') Update
      //-          form(class="update-form" id=doctor.ID action="/admin/doctor-list/update/" + doctor.ID, method="POST")
      //-             input(type='text', name='name', required='')
      //-             input(type='text', name='dob', required='')
      //-             input(type='text', name='gender', required='')
      //-             input(type='text', name='phone', required='')
      //-             input(type="submit" value="Done")
      div#container
         table
            caption Doctor List
            thead
               tr 
                  th Name
                  th DOB
                  th Gender
                  th Phone
            tbody
               tr
                  each doctor in doctors
                     tr
                        td
                           input(type='text', name='name', value = doctor.NAME, required='', readonly=true)
                        td
                           input(type='text', name='dob', value = doctor.DOB, required='', readonly=true) 
                        td
                           input(type='text', name='gender', value = doctor.GENDER, required='', readonly=true)
                        td
                           input(type='text', name='phone', value = doctor.PHONE, required='', readonly=true)
                        td
                           button(type="button" onclick='deleteDoctor('+doctor.ID+')') Delete
                        td
                           button(type="button", class="update-button", onclick='getIndex(' + doctor.ID + ')') Update
                           form(action="/admin/doctor-list/update/" + doctor.ID, method="POST" onsubmit="return submitAddForm(this)" enctype="multipart/form-data")
                              tr(id=doctor.ID, class="update-form")
                                 td
                                    input(type='text', name='name', required='')
                                 td
                                    input(type='text', name='dob', required='')
                                 td
                                    input(type='text', name='gender', required='')
                                 td
                                    input(type='text', name='phone', required='')
                                 td
                                    input(type="submit" value="Done")   
               tr
                  td
                     button(type="button" id="insert-button") Add doctor
                     form(action="/admin/doctor-list/insert" method="POST" onsubmit="return submitAddForm(this)" enctype="multipart/form-data")
                        tr(id="insert-form")
                           td
                              input(type='text', name='name', required='')
                           td
                              input(type='text', name='dob', required='')
                           td
                              input(type='text', name='gender', required='')
                           td
                              input(type='text', name='phone', required='')
                           td
                              input(id="add-btn" type="submit" value="Add")
      script(src="https://code.jquery.com/jquery-3.5.1.min.js")
      script.
         function getIndex(index) {
            $("#" + index).toggle();
         };
         $("#insert-button").click(function(){
            $("#insert-form").toggle();
         });
         function deleteDoctor(index) {
            var req = new XMLHttpRequest();
            req.open("GET", "/admin/doctor-list/delete/" + index);
            req.onreadystatechange = function(){
               if(req.readyState == 4 && req.status == 200){
                  document.getElementById("container").innerHTML = req.responseText;
               }
            }
            req.send(); 
         };

         function submitAddForm(form) {
            var formData = {
               'name'              :     form.name.value,
               'dob'               :     form.dob.value,
               'gender'            :     form.gender.value,
               'phone'             :     form.phone.value
            };
            var req = new XMLHttpRequest();
            req.open(form.getAttribute("method"), form.getAttribute("action"), true);
            req.onreadystatechange = function(){
               if(req.readyState == 4 && req.status == 200){
                  document.getElementById("container").innerHTML = req.responseText;
               }
            }
            req.setRequestHeader('Content-Type','application/json');
            req.send(JSON.stringify(formData));
            return false;
         };

         function submitUpdateForm(form) {
            var formData = {
               'name'              :     form.name.value,
               'dob'               :     form.dob.value,
               'gender'            :     form.gender.value,
               'phone'             :     form.phone.value
            };
            var req = new XMLHttpRequest();
            req.open(form.getAttribute("method"), form.getAttribute("action"), true);
            req.onreadystatechange = function(){
               if(req.readyState == 4 && req.status == 200){
                  document.getElementById("container").innerHTML = req.responseText;
               }
            }
            req.setRequestHeader('Content-Type','application/json');
            req.send(JSON.stringify(formData));
            return false;
         };

