extends ../structure.pug

block metadata
   meta(charset='UTF-8')
   meta(name="viewport" content="width=device-width, initial-scales=1.0")
   // CSS scripts
   link(rel="stylesheet" href="/styles/navBar.css")
   link(rel="stylesheet" href="/styles/index.css")
   link(rel='stylesheet' href='https://use.fontawesome.com/releases/v5.15.1/css/all.css' integrity='sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp' crossorigin='anonymous')
   link(rel="stylesheet" href="/styles/form.css")
   link(rel="stylesheet" href="/styles/list.css")
   link(rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css")
block navBar
   include ../../components/userNavBar

block main
   div#container
      include ../../components/patientList

   script(src="https://code.jquery.com/jquery-3.5.1.min.js")
   script(src="https://code.jquery.com/ui/1.12.1/jquery-ui.js")
   script.
      function getIndex(index) {
         $("#" + index).toggle();
      };
      $("#insert-button").click(function(){
         $("#insert-form").toggle();
      });
      $( function() {
         $( "#datepicker" ).datepicker();
      } );
      $( function() {
         $( 'input[name="dob"]' ).datepicker(
            //- 'format': 'yyyy-mm-dd',
            //- 'autoclose': true
         );
      } );
      function deletePatient(index) {
         fetch("/admin/patient-list/delete/" + index).then(function(response) {
            return response.text().then(function(text) {
               document.getElementById("container").innerHTML = text;
            });
         });
      }
      function submitAddForm(form) {
         var formData = {
            'name'              :     form.name.value,
            'dob'               :     form.dob.value,
            'gender'            :     form.gender.value,
            'phone'             :     form.phone.value
         };
         var req = new XMLHttpRequest();
         req.open(form.getAttribute("method"), form.getAttribute("action"), true);
         req.onreadystatechange = function(){
            if(req.readyState == 4 && req.status == 200){
               document.getElementById("container").innerHTML = req.responseText;
            }
         }
         req.setRequestHeader('Content-Type','application/json');
         req.send(JSON.stringify(formData));
         return false;
      };

      function submitUpdateForm(form) {
         var formData = {
            'name'              :     form.name.value,
            'dob'               :     form.dob.value,
            'gender'            :     form.gender.value,
            'phone'             :     form.phone.value
         };
         var req = new XMLHttpRequest();
         req.open(form.getAttribute("method"), form.getAttribute("action"), true);
         req.onreadystatechange = function(){
            if(req.readyState == 4 && req.status == 200){
               document.getElementById("container").innerHTML = req.responseText;
            }
         }
         req.setRequestHeader('Content-Type','application/json');
         req.send(JSON.stringify(formData));
         return false;
      };
